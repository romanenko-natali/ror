<head>
  <%= stylesheet_link_tag 'user', media: 'all', 'data-turbolinks-track': 'reload' %>
  <%= stylesheet_link_tag 'headline', media: 'all' %>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" integrity="sha512-Fo3rlrZj/k7ujTnHg4CGR2D7kSs0v4LLanw2qksYuRlEzO+tcaEPQogQ0KaoGN26/zrn20ImR1DfuLWnOo7aBA==" crossorigin="anonymous" referrerpolicy="no-referrer" />
</head>

<div class="header-container">
  <h1 class="project-heading"><%= @user.name %></h1>
  <div class="header-links">
    <%= link_to "Projects", projects_path %>
    <%= link_to "Tasks", todos_path %>
    <%= link_to "Account", edit_user_path(@user) %>
    <%= link_to 'Logout', logout_path, data: { confirm: 'Are you sure you want to logout?' } %>
  </div>
</div>  

<div class="user-info-container">
  <%= form_with(model: @user, url: user_path(@user), method: :patch, html: { onsubmit: "return confirmUpdate();" }) do |form| %>
    <div class="field">
      <%= form.label :name, class: "label-large" %>
      <%= form.text_field :name, class: "form-control" %>
      <% if @user.errors.has_key?(:name) %>
        <div class="error">
          <%= @user.errors[:name].first %>
        </div>
      <% end %>
    </div>

    <div class="field">
      <%= form.label :email, class: "label-large" %>
      <%= form.text_field :email, class: "form-control" %>
      <% if @user.errors.has_key?(:email) %>
        <div class="error">
          <%= @user.errors[:email].first %>
        </div>
      <% end %>
    </div>

    <div class="field">
      <%= form.label :password, class: "label-large" %>
      <%= form.password_field :password, class: "form-control", id: "fakePassword" %>
      <span><i id="toggler" class="far fa-eye"></i></span>
      <% if @user.errors.has_key?(:password) %>
        <div class="error">
          <%= @user.errors[:password].first %>
        </div>
      <% end %>
    </div>
    
    <div class="buttons-container">
      <%= form.submit "Update User", class: "button" %>  
      <%= link_to "Cancel", user_path(@user), class: "button" %>
    </div>
  <% end %>   
</div>


<script>
var password = document.getElementById('fakePassword');
var toggler = document.getElementById('toggler');

function showHidePassword() {
  if (password.type == 'password') {
    password.setAttribute('type', 'text');
    toggler.classList.add('fa-eye-slash');
  } else {
    toggler.classList.remove('fa-eye-slash');
    password.setAttribute('type', 'password');
  }
}

toggler.addEventListener('click', showHidePassword);

function confirmUpdate() {
  return confirm("Are you sure you want to update your information?");
}
</script>
